# 拖动文件到cmd上

> 2024年3月26日09:33:25

我们有的时候可以把文件直接拖动cmd脚本上，通过文件的路径来执行一些命令。

* 不过我建议直接弄成手动输入，这样打开cmd窗口后，将对应文件拖到窗口可以直接获取文件路径。

## 样例

在CMD脚本中，你可以使用 %~dp0 命令获取脚本所在的路径，而 %1, %2, %3等则可以获取到你拖曳到脚本上的文件的完整路径。

例如：
假设我们的脚本名字是myScript.cmd，内容如下：

```bash
@echo off
pushd %~dp0
echo You dropped %1 on me!
pause
```

那么当你将一个文件拖曳到这个脚本上时，%1 会被替换为你拖曳文件的完整路径。如果你拖曳了两个文件，那么 %1 是第一个文件的路径，%2 是第二个文件的路径。注意，这里路径包括文件名。可以使用%~n1获取文件名，可以使用%~dp1获取文件所在的路径。

* 这时我拖动桌面的`待办.txt`文件到cmd脚本上时(不打开),会输出以下信息

```text
You dropped C:\Users\LiHuiRuo\Desktop\待办.txt on me!
请按任意键继续. . .
```

## 语法解释

* `@echo off`：屏蔽cmd的命令以及文件路径，只留下最纯粹的输出
* `pushd`会改变当前的目录，但也跟踪你在哪里，所以你可以通过使用相应的popd命令返回。
* `%~dp0`：表示cmd脚本文件所在的目录。
* `pushd %~dp0`：表示cmd执行命令的目录是cmd脚本所在的目录，如果不加这个，会导致在拖动文件的目录执行命令(大多数情况下都会出问题)。
* `pause`：暂停，防止执行完脚本直接闪退。